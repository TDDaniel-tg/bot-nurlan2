"""Текстовые сообщения бота"""

# Стартовые сообщения
START_MESSAGE = """
🤖 **Добро пожаловать в PDF to Excel конвертер!**

Я помогу вам быстро и легко конвертировать PDF файлы в формат Excel (XLSX).

📋 **Как использовать:**
1️⃣ Отправьте мне PDF файл
2️⃣ Дождитесь завершения конвертации
3️⃣ Получите готовый XLSX файл

⚙️ **Доступные команды:**
• /start - показать это сообщение
• /help - справка по использованию
• /convert - начать конвертацию
• /status - проверить статус обработки

📝 **Ограничения:**
• Максимальный размер файла: 20 МБ
• Поддерживается только формат PDF
• До 50 страниц в документе
• 1 файл в минуту

Просто отправьте мне ваш PDF файл, и я приступлю к работе! 🚀
"""

HELP_MESSAGE = """
📖 **Справка по использованию бота**

🔧 **Команды:**
• /start - приветствие и инструкция
• /help - эта справка
• /convert - начать процесс конвертации
• /status - проверить статус текущих задач

📤 **Как конвертировать файл:**
1. Отправьте PDF файл боту (как документ)
2. Подождите сообщение о начале обработки
3. Дождитесь завершения конвертации
4. Скачайте готовый XLSX файл

⚠️ **Важные ограничения:**
• **Размер файла:** максимум 20 МБ
• **Формат:** только PDF файлы
• **Страницы:** до 50 страниц
• **Частота:** 1 файл в минуту на пользователя

🔄 **Статусы обработки:**
• ⏳ Обработка - файл принят в работу
• 🔄 Конвертация - идет процесс преобразования
• ✅ Готово - файл успешно конвертирован
• ❌ Ошибка - что-то пошло не так

💡 **Советы:**
• Убедитесь, что PDF содержит текст или таблицы
• Для лучшего результата используйте четкие PDF файлы
• При ошибке попробуйте отправить файл повторно

❓ По вопросам обращайтесь к администратору.
"""

CONVERT_MESSAGE = """
📤 **Начнем конвертацию!**

Отправьте мне PDF файл, который нужно конвертировать в Excel.

⚠️ **Помните об ограничениях:**
• Максимальный размер: 20 МБ
• Только PDF формат
• До 50 страниц

Просто прикрепите файл к сообщению и отправьте! 📎
"""

# Сообщения процесса обработки
PROCESSING_START = "⏳ **Начинаю обработку файла...**\n\nФайл: `{filename}`\nРазмер: `{size} МБ`"

UPLOADING_MESSAGE = "📤 **Загружаю файл в сервис конвертации...**"

CONVERTING_MESSAGE = "🔄 **Конвертирую PDF в Excel...**\n\nЭто может занять несколько минут. Пожалуйста, ожидайте..."

CONVERSION_SUCCESS = """
✅ **Конвертация завершена успешно!**

📄 Ваш PDF файл был конвертирован в XLSX формат
🔧 Применена принудительная замена украинских символов на русские
🤖 Качество текста улучшено с помощью ИИ

Файл готов к использованию!
"""

SENDING_FILE = "📨 **Отправляю готовый файл...**"

# Сообщения об ошибках
ERROR_FILE_TOO_LARGE = "❌ **Файл слишком большой!**\n\nМаксимально допустимый размер: **20 МБ**\nРазмер вашего файла: **{size} МБ**"

ERROR_INVALID_FORMAT = "❌ **Неподдерживаемый формат файла!**\n\nЯ принимаю только **PDF файлы**.\nПожалуйста, отправьте файл с расширением `.pdf`"

ERROR_CONVERSION_FAILED = """
❌ **Не удалось конвертировать файл**

Возможные причины:
• PDF файл поврежден или защищен паролем
• Файл содержит только изображения без текста
• Внутренняя ошибка сервиса конвертации

💡 **Попробуйте:**
• Отправить другой PDF файл
• Убедиться, что файл не защищен
• Повторить попытку через несколько минут
"""

ERROR_API_UNAVAILABLE = """
❌ **Сервис конвертации временно недоступен**

Пожалуйста, попробуйте позже через несколько минут.

Если проблема повторяется, обратитесь к администратору.
"""

ERROR_TIMEOUT = """
❌ **Превышено время ожидания**

Конвертация заняла слишком много времени и была прервана.

💡 **Рекомендации:**
• Попробуйте с файлом меньшего размера
• Убедитесь, что PDF содержит не более 50 страниц
• Повторите попытку позже
"""

ERROR_RATE_LIMIT = """
❌ **Слишком частые запросы**

Вы можете отправлять не более **1 файла в минуту**.

⏰ Попробуйте через минуту.
"""

ERROR_NO_FILE = """
❌ **Файл не найден**

Пожалуйста, отправьте PDF файл для конвертации.

Используйте команду /convert для начала процесса.
"""

# Статусные сообщения
STATUS_NO_ACTIVE_TASKS = "ℹ️ **Нет активных задач**\n\nВ данный момент у вас нет файлов в обработке."

STATUS_ACTIVE_TASK = """
📊 **Статус текущей задачи**

📄 **Файл:** `{filename}`
🔄 **Статус:** {status}
⏰ **Начато:** {started_at}

Ожидайте завершения обработки...
"""

# Сообщения отмены
CANCEL_SUCCESS = "✅ **Операция отменена**\n\nВы можете начать новую конвертацию в любое время."

CANCEL_NO_TASK = "ℹ️ **Нет активных задач для отмены**"

# Общие сообщения
UNKNOWN_COMMAND = """
❓ **Неизвестная команда**

Используйте доступные команды:
• /start - начать работу
• /help - справка
• /convert - конвертировать файл
• /status - проверить статус

Или просто отправьте PDF файл для конвертации.
"""

BOT_MAINTENANCE = """
🔧 **Технические работы**

Бот временно недоступен из-за технических работ.
Попробуйте позже.

Приносим извинения за неудобства.
"""

# Эмодзи для статусов
STATUS_EMOJIS = {
    'waiting': '⏳',
    'uploading': '📤',
    'processing': '🔄',
    'converting': '⚙️',
    'downloading': '📥',
    'completed': '✅',
    'error': '❌',
    'cancelled': '🚫'
}

def get_status_message(status: str) -> str:
    """Получение эмодзи для статуса"""
    return STATUS_EMOJIS.get(status, '❓')

CONVERSION_MESSAGES = {
    'start': "🔄 Начинаю конвертацию файла...",
    'uploading': "📤 Загружаю файл в CloudConvert...",
    'processing': "⚙️ Обрабатываю PDF с улучшенными настройками OCR...",
    'downloading': "📥 Скачиваю конвертированный файл...",
    'ukrainian_fix': "🇺🇦➡️🇷🇺 Принудительно исправляю украинский текст на русский...",
    'enhancing': "🤖 Улучшаю качество текста с помощью ИИ...",
    'finalizing': "✅ Завершаю обработку файла...",
    'success': "🎉 Конвертация завершена успешно!",
    'error': "❌ Произошла ошибка при конвертации"
} 